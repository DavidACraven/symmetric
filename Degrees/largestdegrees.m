intrinsic MaximalSymmetricCharacterDegree(n::RngIntElt) -> RngIntElt,SetEnum
{Returns the largest degree of an irreducible character of the symmetric group of degree n. The first output is the degree, the second is the set of partitions corresponding to the irreducible characters of that degree. For n at most 134 this is returned from a lookup table. Otherwise the result is calculated, which will take a long time and definitely fail if you computer has less than 1TB of RAM.}

requirege n,1;

MaximalDegrees:=[1,1,2,3,6,16,35,90,216,768,2310,7700,21450,69498,292864,1153152,4873050,16336320,64664600,249420600,1118939184,5462865408,28542158568,117487079424,
547591590000,2474843571200,12760912164000,57424104738000,295284192952320,1865134921890240,9241827385190400,50385731994259200,268401306245529600,1579812376072320000,
7821859115070000000,40971642983700000000,222250513478508715200,1592694283209952665600,9335226290275709091840,58965081685061803130880,366086379166733146521600,
2455861544135906461632000,14064743140340298422496480,82628724406182220050744960,500283928761422348434320000,3099186881321017005002484000,20368873512400427423405568000,
139108709149402516499579535360,1007882872827294450598918225920,7213044178117167522200420352000,54862456282689907329134847590400,360271734400780906661162863257600,
2416328017978835907706221223561800,16032089198265876501244987648140000,112332940080014807351231850047731500,780924182374434489607494144716850000,
5759492688586530968032605948341040000,39204228543251710567342810799102400000,284360991016399770894957040134389760000,2321999844171845578871179664651452416000,
19896436084338134974427586952682903961600,148493270650299093215991941843059928064000,1128084815471490923775238783188995891011200,8229081864439402212381478702631306868113280,
64744511859060420712290642354586811061519360,492648887206925778427244427860670202969057200,4025571251354748853301084014788823689834654000,
30473167912125109106974726128840645867371520000,234417911643806987948678393500955835502166016000,1788611255686599443441275423897069708421376000000,
14061798146634215100928457529846541203122400000000,130752274327952321538989760952406388528535044096000,1099941833914297566548100976306304543754345185280000,
9393814297722007346466225462665628282244030499904000,75591730449481189068765207148175917862445398493000000,660943493657107495213974182754150511637360513303040000,
5507479956694844226612276769373271537654140064265320000,49718318339225029555103035309089735554926840176109440000,418920939879777844937260609944023276410019030898651955200,
3579026417818008407776702958356552842464133458949423759360,29326030832439019031092736803263846956891854060380047278080,245717058969967243667527972726893680531472205822714908672000,
1958510306535009521762165974428282510483897121566558093312000,17199984970509310503422142406316778944531851299986079744000000,161866387856671801830938160974282163319008607501789408788480000,
1543188965753898098745955145496379055557243125097337202422906880,13652515506675457063836747192041480586149162971910780027773255200,132012112829058929697216055665548406632996088226054058331660288000,
1202770010851978089499001986967434093160593877549352313484968012800,11952161805200485671523852732672950906233029612342903238952910848000,
111536354532746933705105521827401388958780700059721074267272511488000,1053454252419345014848313815715121307642151973096789037261887897600000,
9298019732498692589306447931761769662631984023874447420141412024320000,83528869990036960061655065586806227330592230516749107406742623092736000,
738856195291160637064439093409373209747689102713743192921850842710016000,6830694040117548932247228149858288447418106733746110630642358121073868800,
63933734724523910394059324668425220557070884535418451305089068784299552000,587608644132988669062315659190628313018199189598748549625037176301076447232,
5629956124941094770622386912044341575706909420518139046529417862613615814000,54539477511295000975066379739366669128884298419169669212903038310103287500000,
565378959002571348526487738883086152928500083237801155401255766231772364800000,5686551912381574511129147722159555766486912859732682235293686582973153935360000, 61214329016711158166505670767097073373225632044596866872062611556033207085301760,629571928828905856385137619784652309874964139464234066432099908346091489198080000,
6543617427878537957159797488174446866494284857950790449673796864650405478400000000,62248998806107993222904021013832709197228288195326145558076624865148293611520000000,
600822535255522047374450656754652331112658343843410146461744233385203670292889600000,5859053607504252923711044267102909797677033029585662217958005496073729528960122880000,
59379551491616867820813793786673418100650673100467326423241849100982654799687188480000,593754279116521722049929039398826768910603501370575717477957906392395310042149879808000,
5843131836928986744562472498190299615029892226822600183226816624070074070360015831040000,61105493625303738395253114613131217949919457622033925706446568203732810893059278458880000,
645284300395922462346988764778610006799667957567032614439503191406364806919846176670528000,6471311714640738998035388676878361545551725384849470054442985279137987684523862560930800000,
66128905523715119393658109922164820371664898533283474357337419642390289909199389685625000000,638413540225466549323771634427856615642473725894742100863592254944610659948329752000000000000,
7264677475665757809588865469324114857951498304424610468804884130954372253510635214340096000000,81957821889006269343939932925565702494371135067346828364830110395108173678039294474715136000000,
933265651485302990456973680195002814630181335963531167035311179395532156804616895040428441600000,9561748744622283052749506679404608802911488096180764339610035441459656958678315846074368000000000,
99168394465082746801226508797212412342381673249847876815200769992656534951269110277734400000000000,1060317412401790133664921362238355614964072509661204015496834618921891762559143365769696343647846400,
11735633863911204938490639412913207457256769393971699554486924429354933320408383703506908708864000000,125523394771381975831786289849651910702470806649337320960975362584641188490390808459367474046668800000,
1322896608562657954567427866796349722403587506448681903827035398815645964192770284234405686280192000000,15053793377258935921026197289527106978430680279327971210023260869830845635254897943633742871848960000000,
172796287471960987860822815262100856489260856157731537393069903298538421091240496540395511426764480000000,1833008139189744060655687517745838727856197212468517540568765333173580850312094186536014481201471488000000,
19733338904897136848652524451398725618283047755321823547856141401392164546581430011844388902685979443200000,200534932023735151679946820980226809219196038868645819410390500611064332442495282408304952199479296000000000,
2122735461683156019264203330227856209122179197425703850494039038120750966572155464908542450271495651328000000,22023678843442451997799208731033593155726813961332400647060525628383438796780784758181516770009833275392000000,
266124582022533412468479293246197893319663607744492553808837457658052204464108991413097141752703934791680000000,3306013929179103943043901815888913835215541080396985145337839749334237802268176600068570956603751209422028800000,
36426421823787422423850536980861410755870124327132086522562760105586889562061526866373613512329736172339200000000
];

WitnessPartitions:=[{[1]},{[2],[1,1]},{[2,1]},{[2,1,1],[3,1]},{[3,1,1]},{[3,2,1]},{[4,2,1],[3,2,1,1]},{[4,2,1,1]},{[4,2,2,1],[4,3,1,1]},{[4,3,2,1]},{[4,3,2,1,1],[5,3,2,1]},
{[5,3,2,1,1]},{[5,3,2,2,1],[5,4,2,1,1]},{[6,4,2,1,1],[5,3,2,2,1,1]},{[5,4,3,2,1]},{[6,4,3,2,1],[5,4,3,2,1,1]},{[6,4,3,2,1,1]},{[7,4,3,2,1,1],[6,4,3,2,1,1,1]},
{[6,4,3,2,2,1,1],[7,5,3,2,1,1]},{[7,5,3,2,2,1],[6,5,3,2,2,1,1]},{[7,5,3,2,2,1,1]},{[7,5,4,3,2,1],[6,5,4,3,2,1,1]},{[7,5,4,3,2,1,1]},
{[8,5,4,3,2,1,1],[7,5,4,3,2,1,1,1]},{[8,6,4,3,2,1,1],[7,5,4,3,2,2,1,1]},{[8,5,4,3,2,2,1,1],[8,6,4,3,2,1,1,1]},{[8,6,4,3,2,2,1,1]},{[8,6,5,3,2,2,1,1],[8,6,4,3,3,2,1,1]},
{[8,6,5,4,3,2,1],[7,6,5,4,3,2,1,1]},{[8,6,5,4,3,2,1,1]},{[8,6,5,4,3,2,1,1,1],[9,6,5,4,3,2,1,1]},{[8,6,5,4,3,2,2,1,1],[9,7,5,4,3,2,1,1]},
{[9,6,5,4,3,2,2,1,1],[9,7,5,4,3,2,1,1,1]},{[9,7,5,4,3,2,2,1,1]},{[9,7,5,4,3,3,2,1,1],[9,7,6,4,3,2,2,1,1]},{[9,7,6,4,3,3,2,1,1]},
{[10,8,6,4,3,2,2,1,1],[9,7,5,4,3,3,2,2,1,1]},{[9,7,6,5,4,3,2,1,1]},{[10,7,6,5,4,3,2,1,1],[9,7,6,5,4,3,2,1,1,1]},{[10,8,6,5,4,3,2,1,1],[9,7,6,5,4,3,2,2,1,1]},
{[10,7,6,5,4,3,2,2,1,1],[10,8,6,5,4,3,2,1,1,1]},{[10,8,6,5,4,3,2,2,1,1]},{[11,8,6,5,4,3,2,2,1,1],[10,8,6,5,4,3,2,2,1,1,1]},{[11,8,6,5,4,3,2,2,1,1,1]},
{[11,9,7,5,4,3,2,2,1,1],[10,8,6,5,4,3,3,2,2,1,1]},{[11,9,7,5,4,3,2,2,1,1,1],[11,8,6,5,4,3,3,2,2,1,1]},{[10,8,7,6,5,4,3,2,1,1]},{[11,8,7,6,5,4,3,2,1,1],[10,8,7,6,5,4,3,2,1,1,1]},
{[11,9,7,6,5,4,3,2,1,1],[10,8,7,6,5,4,3,2,2,1,1]},{[11,9,7,6,5,4,3,2,1,1,1],[11,8,7,6,5,4,3,2,2,1,1]},{[11,9,7,6,5,4,3,2,2,1,1]},
{[11,9,7,6,5,4,3,2,2,1,1,1],[12,9,7,6,5,4,3,2,2,1,1]},{[12,9,7,6,5,4,3,2,2,1,1,1]},{[12,10,8,6,5,4,3,2,2,1,1],[11,9,7,6,5,4,3,3,2,2,1,1]},
{[12,9,7,6,5,4,3,3,2,2,1,1],[12,10,8,6,5,4,3,2,2,1,1,1]},{[12,9,8,6,5,4,3,3,2,2,1,1],[12,10,8,6,5,4,3,3,2,1,1,1]},{[12,10,8,6,5,4,3,3,2,2,1,1]},
{[12,10,8,7,5,4,3,3,2,2,1,1],[12,10,8,6,5,4,4,3,2,2,1,1]},{[12,10,8,7,6,5,4,3,2,1,1],[11,9,8,7,6,5,4,3,2,2,1,1]},{[12,9,8,7,6,5,4,3,2,2,1,1],[12,10,8,7,6,5,4,3,2,1,1,1]},
{[12,10,8,7,6,5,4,3,2,2,1,1]},{[12,10,8,7,6,5,4,3,2,2,1,1,1],[13,10,8,7,6,5,4,3,2,2,1,1]},{[13,10,8,7,6,5,4,3,2,2,1,1,1]},{[13,10,8,7,6,5,4,3,3,2,1,1,1],
[13,10,9,7,6,5,4,3,2,2,1,1,1]},{[13,11,9,7,6,5,4,3,2,2,1,1,1],[13,10,8,7,6,5,4,3,3,2,2,1,1]},{[13,11,9,7,6,5,4,3,3,2,1,1,1],[13,10,9,7,6,5,4,3,3,2,2,1,1]},
{[13,11,9,7,6,5,4,3,3,2,2,1,1]},{[13,11,9,7,6,5,4,3,3,2,2,1,1,1],[14,11,9,7,6,5,4,3,3,2,2,1,1]},{[14,11,9,7,6,5,4,3,3,2,2,1,1,1]},
{[14,11,9,7,6,5,4,4,3,2,2,1,1,1],[14,11,9,8,6,5,4,3,3,2,2,1,1,1]},{[14,11,9,8,6,5,4,4,3,2,2,1,1,1]},{[13,11,9,8,7,6,5,4,3,2,2,1,1]},{[14,11,9,8,7,6,5,4,3,2,2,1,1],
[13,11,9,8,7,6,5,4,3,2,2,1,1,1]},{[14,11,9,8,7,6,5,4,3,2,2,1,1,1]},{[14,11,10,8,7,6,5,4,3,2,2,1,1,1],[14,11,9,8,7,6,5,4,3,3,2,1,1,1]},{[14,11,9,8,7,6,5,4,3,3,2,2,1,1],
[14,12,10,8,7,6,5,4,3,2,2,1,1,1]},{[14,11,10,8,7,6,5,4,3,3,2,2,1,1],[14,12,10,8,7,6,5,4,3,3,2,1,1,1]},{[14,12,10,8,7,6,5,4,3,3,2,2,1,1]},
{[15,12,10,8,7,6,5,4,3,3,2,2,1,1],[14,12,10,8,7,6,5,4,3,3,2,2,1,1,1]},{[15,12,10,8,7,6,5,4,3,3,2,2,1,1,1]},{[15,12,10,8,7,6,5,4,4,3,2,2,1,1,1],
[15,12,10,9,7,6,5,4,3,3,2,2,1,1,1]},{[15,12,10,9,7,6,5,4,4,3,2,2,1,1,1]},{[15,12,10,8,7,6,5,4,4,3,3,2,2,1,1],[15,13,11,9,7,6,5,4,3,3,2,2,1,1,1]},
{[14,12,10,9,8,7,6,5,4,3,2,2,1,1]},{[14,12,10,9,8,7,6,5,4,3,2,2,1,1,1],[15,12,10,9,8,7,6,5,4,3,2,2,1,1]},{[15,12,10,9,8,7,6,5,4,3,2,2,1,1,1]},
{[15,12,10,9,8,7,6,5,4,3,3,2,1,1,1],[15,12,11,9,8,7,6,5,4,3,2,2,1,1,1]},{[15,12,10,9,8,7,6,5,4,3,3,2,2,1,1],[15,13,11,9,8,7,6,5,4,3,2,2,1,1,1]},
{[15,12,11,9,8,7,6,5,4,3,3,2,2,1,1],[15,13,11,9,8,7,6,5,4,3,3,2,1,1,1]},{[15,13,11,9,8,7,6,5,4,3,3,2,2,1,1]},{[15,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1],
[16,13,11,9,8,7,6,5,4,3,3,2,2,1,1]},{[16,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[16,13,11,9,8,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,4,3,3,2,2,1,1,1]},
{[16,13,11,10,8,7,6,5,4,4,3,2,2,1,1,1]},{[16,14,12,10,8,7,6,5,4,3,3,2,2,1,1,1],[16,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1]},{[16,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1],
[17,14,12,10,8,7,6,5,4,3,3,2,2,1,1,1]},{[17,14,12,10,8,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[16,14,12,10,8,7,6,5,4,4,3,3,2,2,1,1]},
{[17,14,12,10,8,7,6,5,4,4,3,3,2,2,1,1],[16,14,12,10,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[17,14,12,10,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[16,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1],
[16,14,12,10,9,8,7,6,5,4,3,2,2,1,1,1]},{[17,14,12,10,9,8,7,6,5,4,3,2,2,1,1,1],[16,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[16,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1]},
{[17,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1],[16,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[17,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[17,14,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1],
[17,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[17,14,12,11,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[17,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1],[17,15,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[18,15,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1],[17,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[18,15,13,11,9,8,7,6,5,4,4,3,2,2,1,1,1],[17,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},
{[17,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1]},{[18,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1],[17,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[18,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},
{[18,15,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[18,15,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[18,15,13,11,10,9,7,6,5,5,4,3,3,2,2,1,1,1],
[18,15,13,11,10,8,7,6,6,5,4,3,3,2,2,1,1,1]},{[17,15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1]},{[18,15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1],[17,15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[18,15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[18,15,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[18,15,13,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},
{[18,15,13,11,10,9,8,7,6,5,4,4,3,3,2,2,1,1],[18,16,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[19,16,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},
{[18,15,13,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1],[19,16,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[18,16,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1]},{[19,16,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1],
[18,16,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[19,16,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[19,16,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},
{[19,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[19,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1,1],[20,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[19,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,2,1,1,1],
[20,17,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[20,17,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1],[19,16,14,12,10,9,8,7,6,5,5,4,4,3,3,2,2,1,1,1]},{[19,16,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1],
[18,16,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[19,16,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[19,16,14,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,10,9,8,7,6,5,4,4,3,2,2,1,1,1]}
];

if(n le #MaximalDegrees) then
  return MaximalDegrees[n],WitnessPartitions[n];
end if;

num:=NumberOfPartitions(n);
P:=[n];
MaxDeg:=0;
TheChars:={};
g:=Sym(n)!1;
for i in [1..num] do
  nn:=SymmetricCharacterValue(P,g);
  if(nn gt MaxDeg) then
    MaxDeg:=nn;
    TheChars:={P};
  elif(nn eq MaxDeg) then
    Include(~TheChars,P);
  end if;
  P:=NextPartition(P,n);
end for;

return MaxDeg,TheChars;

end intrinsic;


intrinsic SecondMaximalSymmetricCharacterDegree(n::RngIntElt) -> RngIntElt,SetEnum
{Returns the second largest degree of an irreducible character of the symmetric group of degree n. The first output is the degree, the second is the set of partitions corresponding to the irreducible characters of that degree. For n at most 134 this is returned from a lookup table. Otherwise the result is calculated, which will take a long time and definitely fail if you computer has less than 1TB of RAM.}

requirege n,1;

MaximalDegrees2:=[0,0,1,2,5,10,21,70,189,567,1540,5775,20592,68640,243243,928746,3620864,16243500,58786000,245583360,1100742656,4786573176,
21422145536,113519948850,506341621760,2416839425000,10440746316000,54111175618500,285479834983200,1409655074979840,8756270438585670,
47456261347737600,255865045283347500,1283821849908449280,7818730371423972000,40955254326506520000,222028484993515200000,1252906740818406273600,
8718756908165733068640,56293098100801331527680,343239496677842482317600,2039823294542606752058880,13541929087476046717687500,
81625741439474946201988500,492955458105064380984558000,3054000144489287747513760000,19781229847444022118349188000,131523199341227809284668378880,
972262573543987434666653122560,6680577809401402669876944230400,46312463095777194498620325888000,337532690020455484544481972480000,
2323687734048305937945270691053000,15941204752095668567582219655896400,108198222299291868105761671872600000,729678274400207178048792647150092800,
5181140209358884504577381502609645000,38979919543322107646105630063443200000,279215849926698053862337275266035200000,
2130355181778193504195583487256811520000,17007665978986057507075639207109473075200,136276098549973482202234745290085766758400,
1063002999194289524326667314928092281914400,8216119973348514614043123373634467951411200,61393281804436066505530242426209881502897760,
473396604363041601805359644726563159867392000,3666867793395906602085039742089100593705408000,29367242574417359760333385068605335559961000000,
228395986106084749907723340053225763227208000000,1748469361982123350431851372149578559020000000000,13634567227655341297745538195377044548415075123200,
112894616095197973660410138646536246547728826368000,993165473440578715010905644035739717644690915328000,8711348683422039396075160954340584780389750561792000,
75024198301295139996574118815111831466917513396224000,619555751527120333936154050743873209147101501374000000,
5406336237709641685071675779232171844019498872012800000,45738449311060710787219669541644678827255588503927040000,
391333613319716238764783348199233954100567566353265250000,3380809647340755223169978638259664061741408012834990080000,
27636234893103174184156908530900471767813492893380430000000,225258464111525966236721528143696834317059165812782492057600,
1932093626837323881427240056468368819439641062845533080320000,16976592513364128324499256198795958191644342195129907804160000,
144691553610615319212484345747454322527295978739167789000000000,1412639065538055583451708147375074926678413613873648740851200000,
13482594359329660603951518658295548419236724806512456713948364800,122650536448361569650603145778611444372781418502398902450918930400,
1200791778111868138708875136459710169777023297503773305549619200000,11084363692455008644703696910657394530853198298955729364724121600000,
101718218598085037487586435018237685685268936785027598516863267840000,971650759814065952852896975016659032807294715479751846922677518336000,
8577958446526955467456829322445245277040252923388079603108594843648000,78263553363323012164862566628765329925473731719161162333159117025280000,
712761025926530784629494106855437225082857306059917364434711455959360000,6830090039794578753255240721070056123153260200311079124184903661322240000,
61289028837382771111379499242207527909099148807684817778660747567440000000,583669744597961387223872348014343456341938646614053880832080225237695250000,
5482910610638287516340586440502650831554608567513326404925492641959837696000,53128809368868291423086597723461193285671450205775257056656061115291635200000,
521570311584315784228272843418669031825835569792922387312130460742319448700000,5618069821501558432756203523255456024598543579997465440720040002580259904640000, 57151677107559376140012816715413754625581818416494792603810232658480622080000000,563220244084299587799342018774533319474583879035693503899530134756018233922027520, 5921360608442390743767504728849034556174484264498863607125852719022723631677440000,58635190086470624421750715855034367026019414909442279083144192939555469393920000000,
572382331490826175165798902333065782200936279367402996595989420671208172027904000000,5630384780552650921889112303819964860622826022208919347628713779854182175625216000000,
57953075083077827095342510195775873708086797245639145179792155521381303853189693440000,565150731870815158905332613258401547719882897574945807234264518516460182441051750400000,
5742366167139690333831183452715558495255333226205737821351846173141478884510655823872000,58477657442574599715667632668074926266343854018477663087969825009417302738769755140864000,
606173349743863662000293649330548572752510612160377094574672435034875554006124349072000000,6097845413131989701873773385040269662147695069025532541054789075261995408976742119375000000,
60968217913281958276562723944914432717728808722203950485015791557445255692884479104900000000,625030097173092096917917450415965717144978336971748059453454013095110751963020299813781504000,
6821137501105997259988035730408020570658935673683418733316294698575974369078228709854412800000,73211776233359969468639180870030386103614111010365101581523280549105139554024359952033775616000,
831366922297851101638194019880169707795945107908477883918124612621593152371590257482032742400000,9162283028374208824203718186804786480222856224648686659043507588931467470748977272455168000000000,
95728182904687270639663920669581539933373113350584735055351850172982483173200443386130569625600000,1029462070531476623245857443422470824357158465981170091044586529777017308920545200311557518000000000,
11232967985486720571777298844971657923369647590730384626638991681793320422688726954957893783257088000,119581666321310209547755391664420539256231382686617674884116994060019739948252143622471931025612800000,
1305942599860382777742974278004981607026209871700171890737284082362813152133967808447727216336600000000,14568825011712662370767883439385648263962582749187414460920662375882841514365027043187653238575800000000,
158166698447447651604269538169344370593912637115283927839994278928633284398133419433784313539880800000000,1716001387721584923542913579856160060904625583119127032777563254066055342706553296451640397211369472000000,
18454606282170826832583475848055964984212266057632891575857718069679728718018944005964951197705358540800000,198008169074453471018145227602545330974489573865841706405476091201950319700751750203361076758475980800000000,
2054983320016374493433434170804596607444904675701603992806075337578898453611496349476491130830848000000000000,21937777455964737349453960861407460945208530521320081612761117481430725829413002881817774628401682841600000000,
247255696247142945060209062919568425664047173819032218835215385849221481680112821289974561943481489920000000000,2906509231280140865481996632008545555818441791779164217799192550520182099483901147348563363933460627456000000000,
35410884447003975090183123090430155544313972853408217229640633820348662163673882488694827907183775055872000000000
];


WitnessPartitions2:=[{},{},{[1,1,1],[3]},{[2,2]},{[2,2,1],[3,2]},{[4,1,1],[3,1,1,1]},{[3,2,2],[3,3,1]},{[4,3,1],[3,2,2,1]},{[5,2,1,1],[4,2,1,1,1]},{[4,2,2,1,1],[5,3,1,1]},
{[5,2,2,1,1],[5,3,1,1,1]},{[5,4,2,1],[4,3,2,2,1]},{[6,3,2,1,1],[5,3,2,1,1,1]},{[5,4,2,2,1]},{[6,4,2,2,1],[5,4,2,2,1,1]},{[6,4,2,2,1,1]},{[7,4,3,2,1],
[5,4,3,2,1,1,1]},{[6,4,3,2,2,1],[6,5,3,2,1,1]},{[6,5,3,2,2,1]},{[7,5,3,2,1,1,1],[7,4,3,2,2,1,1]},{[6,5,4,3,2,1]},{[7,5,3,3,2,1,1],[7,5,4,2,2,1,1]},
{[6,5,4,3,2,1,1,1],[8,5,4,3,2,1]},{[7,6,4,3,2,1,1],[7,5,4,3,2,2,1]},{[8,5,4,3,2,1,1,1]},{[7,6,4,3,2,2,1,1],[8,6,4,3,2,2,1]},{[8,5,4,3,3,2,1,1],
[8,6,5,3,2,1,1,1]},{[9,6,4,3,2,2,1,1],[8,6,4,3,2,2,1,1,1]},{[8,6,5,3,3,2,1,1]},{[7,6,5,4,3,2,1,1,1],[9,6,5,4,3,2,1]},{[8,6,5,4,3,2,2,1],[8,7,5,4,3,2,1,1]},
{[9,6,5,4,3,2,1,1,1]},{[9,7,5,4,3,2,2,1],[8,7,5,4,3,2,2,1,1]},{[9,6,5,4,3,2,2,1,1,1],[10,7,5,4,3,2,1,1,1]},{[9,7,5,4,3,2,2,1,1,1],[10,7,5,4,3,2,2,1,1]},
{[10,7,6,4,3,2,2,1,1],[9,7,5,4,3,3,2,1,1,1]},{[10,7,6,4,3,3,2,1,1],[9,7,6,4,3,3,2,1,1,1]},{[10,8,6,4,3,3,2,1,1],[9,7,6,4,3,3,2,2,1,1]},{[9,8,6,5,4,3,2,1,1],
[9,7,6,5,4,3,2,2,1]},{[10,7,6,5,4,3,2,1,1,1]},{[10,8,6,5,4,3,2,2,1],[9,8,6,5,4,3,2,2,1,1]},{[11,8,6,5,4,3,2,1,1,1],[10,7,6,5,4,3,2,2,1,1,1]},
{[10,8,6,5,4,3,3,2,1,1],[10,8,7,5,4,3,2,2,1,1]},{[11,8,7,5,4,3,2,2,1,1],[10,8,6,5,4,3,3,2,1,1,1]},{[11,8,7,5,4,3,2,2,1,1,1],[11,8,6,5,4,3,3,2,1,1,1]},
{[11,8,7,5,4,3,3,2,1,1,1]},{[11,8,7,5,4,3,3,2,2,1,1],[11,9,7,5,4,3,3,2,1,1,1]},{[11,9,7,5,4,3,3,2,2,1,1]},{[11,8,7,6,5,4,3,2,1,1,1]},{[11,9,7,6,5,4,3,2,2,1],
[10,9,7,6,5,4,3,2,2,1,1]},{[12,9,7,6,5,4,3,2,1,1,1],[11,8,7,6,5,4,3,2,2,1,1,1]},{[11,9,8,6,5,4,3,2,2,1,1],[11,9,7,6,5,4,3,3,2,1,1]},{[12,9,8,6,5,4,3,2,2,1,1],
[11,9,7,6,5,4,3,3,2,1,1,1]},{[12,9,7,6,5,4,3,3,2,1,1,1],[12,9,8,6,5,4,3,2,2,1,1,1]},{[12,9,8,6,5,4,3,3,2,1,1,1]},{[13,10,8,6,5,4,3,2,2,1,1,1],[12,9,7,6,5,4,3,3,2,2,1,1,1]},
{[13,10,8,6,5,4,3,3,2,1,1,1],[12,9,8,6,5,4,3,3,2,2,1,1,1]},{[12,10,8,6,5,4,3,3,2,2,1,1,1],[13,10,8,6,5,4,3,3,2,2,1,1]},{[12,10,8,7,5,4,4,3,2,2,1,1]},
{[12,10,8,7,6,5,4,3,2,2,1],[11,10,8,7,6,5,4,3,2,2,1,1]},{[12,9,8,7,6,5,4,3,2,2,1,1,1],[13,10,8,7,6,5,4,3,2,1,1,1]},{[12,10,9,7,6,5,4,3,2,2,1,1],[12,10,8,7,6,5,4,3,3,2,1,1]},
{[13,10,9,7,6,5,4,3,2,2,1,1],[12,10,8,7,6,5,4,3,3,2,1,1,1]},{[12,10,8,7,6,5,4,3,3,2,2,1,1],[13,11,9,7,6,5,4,3,2,2,1,1]},{[13,10,9,7,6,5,4,3,3,2,1,1,1]},
{[13,10,8,7,6,5,4,3,3,2,2,1,1,1],[14,11,9,7,6,5,4,3,2,2,1,1,1]},{[13,10,9,7,6,5,4,3,3,2,2,1,1,1],[14,11,9,7,6,5,4,3,3,2,1,1,1]},{[13,11,9,7,6,5,4,4,3,2,2,1,1],
[13,11,9,8,6,5,4,3,3,2,2,1,1]},{[14,11,9,8,6,5,4,3,3,2,2,1,1],[13,11,9,7,6,5,4,4,3,2,2,1,1,1]},{[14,11,9,8,6,5,4,4,3,2,2,1,1],[13,11,9,8,6,5,4,4,3,2,2,1,1,1]},
{[13,10,9,8,7,6,5,4,3,2,2,1,1],[13,11,9,8,7,6,5,4,3,2,1,1,1]},{[14,11,9,8,7,6,5,4,3,2,1,1,1],[13,10,9,8,7,6,5,4,3,2,2,1,1,1]},{[13,11,10,8,7,6,5,4,3,2,2,1,1],
[13,11,9,8,7,6,5,4,3,3,2,1,1]},{[14,11,10,8,7,6,5,4,3,2,2,1,1],[13,11,9,8,7,6,5,4,3,3,2,1,1,1]},{[14,12,10,8,7,6,5,4,3,2,2,1,1],[13,11,9,8,7,6,5,4,3,3,2,2,1,1]},
{[14,11,10,8,7,6,5,4,3,3,2,1,1,1]},{[15,12,10,8,7,6,5,4,3,2,2,1,1,1],[14,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[14,11,10,8,7,6,5,4,3,3,2,2,1,1,1],[15,12,10,8,7,6,5,4,3,3,2,1,1,1]},
{[14,12,10,9,7,6,5,4,3,3,2,2,1,1],[14,12,10,8,7,6,5,4,4,3,2,2,1,1]},{[15,12,10,9,7,6,5,4,3,3,2,2,1,1],[14,12,10,8,7,6,5,4,4,3,2,2,1,1,1]},
{[15,12,10,9,7,6,5,4,4,3,2,2,1,1],[14,12,10,9,7,6,5,4,4,3,2,2,1,1,1]},{[15,12,10,8,7,6,5,4,4,3,2,2,2,1,1],[15,13,10,9,7,6,5,4,3,3,2,2,1,1,1]},
{[15,12,10,9,8,6,5,4,4,3,2,2,1,1,1],[15,12,10,9,7,6,5,5,4,3,2,2,1,1,1]},{[15,13,11,9,7,6,5,4,4,3,2,2,1,1,1],[15,12,10,9,7,6,5,4,4,3,3,2,2,1,1]},
{[16,13,11,9,7,6,5,4,4,3,2,2,1,1,1],[15,12,10,9,7,6,5,4,4,3,3,2,2,1,1,1]},{[14,12,10,9,8,7,6,5,4,3,3,2,1,1,1],[15,12,11,9,8,7,6,5,4,3,2,2,1,1]},
{[15,13,11,9,8,7,6,5,4,3,2,2,1,1],[14,12,10,9,8,7,6,5,4,3,3,2,2,1,1]},{[15,12,11,9,8,7,6,5,4,3,3,2,1,1,1]},{[15,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],
[16,13,11,9,8,7,6,5,4,3,2,2,1,1,1]},{[16,13,11,9,8,7,6,5,4,3,3,2,1,1,1],[15,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[15,13,11,9,8,7,6,5,4,4,3,2,2,1,1],
[15,13,11,10,8,7,6,5,4,3,3,2,2,1,1]},{[15,13,11,9,8,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,4,3,3,2,2,1,1]},{[16,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1,1],
[17,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[16,14,11,10,8,7,6,5,4,3,3,2,2,1,1,1],[16,13,11,9,8,7,6,5,4,4,3,2,2,2,1,1]},{[16,14,11,10,8,7,6,5,4,4,3,2,2,1,1,1],
[16,13,11,10,8,7,6,5,4,4,3,2,2,2,1,1]},{[16,14,12,10,8,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1]},{[16,14,12,10,9,7,6,5,4,4,3,2,2,1,1,1],
[16,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1]},{[17,14,12,10,9,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[16,13,11,10,9,8,7,6,5,4,3,2,2,1,1,1]},
{[16,13,12,10,9,8,7,6,5,4,3,2,2,1,1,1],[16,13,11,10,9,8,7,6,5,4,3,3,2,1,1,1]},{[16,13,12,10,9,8,7,6,5,4,3,3,2,1,1,1]},{[16,14,12,10,9,8,7,6,5,4,3,3,2,1,1,1],
[16,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1]},{[16,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[17,14,12,10,9,8,7,6,5,4,3,3,2,1,1,1]},{[16,14,12,11,9,8,7,6,5,4,3,3,2,2,1,1],
[16,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1]},{[16,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1],[17,14,12,11,9,8,7,6,5,4,3,3,2,2,1,1]},{[17,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1,1],
[18,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[17,14,12,10,9,8,7,6,5,4,4,3,2,2,2,1,1],[17,15,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[18,15,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1],
[17,14,12,10,9,8,7,6,5,4,4,3,2,2,2,1,1,1]},{[17,15,13,11,9,8,7,6,5,4,4,3,2,2,1,1,1],[17,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1]},{[18,15,13,11,10,8,7,6,5,4,3,3,2,2,1,1,1],
[17,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[17,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,8,7,6,5,4,4,3,2,2,1,1,1]},{[18,15,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1],
[18,15,13,11,9,8,7,6,5,4,4,3,2,2,2,1,1,1]},{[18,15,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1],[17,15,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[17,15,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1],
[18,15,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1]},{[18,15,13,11,9,8,7,6,6,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,9,7,6,5,4,4,3,3,2,2,1,1,1]},{[18,15,13,11,10,9,8,7,6,5,4,3,2,2,1,1,1],
[17,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[18,15,13,11,10,9,8,7,6,5,4,3,3,2,1,1,1],[17,14,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[18,15,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1],
[18,15,13,11,10,9,8,7,6,5,4,3,2,2,2,1,1,1]},{[18,15,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1],[17,15,13,11,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[18,15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1,1],
[19,15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[18,16,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,9,8,7,6,5,4,4,3,2,2,2,1,1]},{[18,15,13,11,10,9,8,7,6,5,4,4,3,2,2,2,1,1,1],
[19,16,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[18,15,13,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1],[18,16,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[19,15,13,11,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1],
[19,16,14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1,1]},{[19,16,14,12,10,9,8,7,6,5,4,4,3,2,2,2,1,1],[18,16,13,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[19,16,13,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1],
[19,16,14,12,10,9,8,7,6,5,4,4,3,2,2,2,1,1,1]},{[19,16,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1],[18,16,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[19,16,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1,1],
[20,16,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[20,16,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1],[19,16,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1,1,1]},{[19,16,14,12,11,9,8,7,6,6,5,4,3,3,2,2,1,1,1],
[19,16,14,12,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[20,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1,1]},{[20,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,2,1,1,1],[20,17,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1,1]},
{[20,17,15,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,9,8,7,6,5,5,4,4,3,3,2,2,1,1,1]},{[19,16,14,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1],[18,16,14,12,11,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},
{[20,16,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1,1]}
];

if(n le #MaximalDegrees2) then
  return MaximalDegrees2[n],WitnessPartitions2[n];
end if;

num:=NumberOfPartitions(n);
P:=[n];
MaxDeg:=0;
TheChars:={};
MaxDeg2:=0;
TheChars2:={};
MaxDeg3:=0;
TheChars3:={};

g:=Sym(n)!1;
for i in [1..num] do
  nn:=SymmetricCharacterValue(P,g);
  if(nn gt MaxDeg) then
    MaxDeg2:=MaxDeg;
    MaxDeg:=nn;
    TheChars2:=TheChars;
    TheChars:={P};
  elif(nn eq MaxDeg) then
    Include(~TheChars,P);
  elif(nn gt MaxDeg2) then
    MaxDeg2:=nn;
    TheChars2:={P};
  elif(nn eq MaxDeg2) then
    Include(~TheChars2,P);
  end if;
  P:=NextPartition(P,n);
end for;

return MaxDeg2,TheChars2;

end intrinsic;


intrinsic ThirdMaximalSymmetricCharacterDegree(n::RngIntElt) -> RngIntElt,SetEnum
{Returns the third largest degree of an irreducible character of the symmetric group of degree n. The first output is the degree, the second is the set of partitions corresponding to the irreducible characters of that degree. For n at most 134 this is returned from a lookup table. Otherwise the result is calculated, which will take a long time and definitely fail if you computer has less than 1TB of RAM.}

requirege n,1;

MaximalDegrees3:=[0,0,0,1,4,9,20,64,168,525,1320,5632,17160,64064,231660,819000,3573570,13366080,58212352,230945000,997682400,4040613720,
20613781188,94893410304,490804314000,2197126750000,10357883250000,48608795688960,271998842775660,1347544675620000,7393461908152320,
45053908502803200,233108107138146240,1270751265463680000,6435825679879596000,40096053186789600000,218296913817153600000,1239533794376104550400,
7445845774006528711680,52647394361662324224000,319840713946921892044320,1951984013916370097664000,11453516735316801975009180,
79765325680170673923880500,480959755956502208260875000,3038418511099036279414200000,18469869138603195255228000000,128503628482643873009426304000,
899006636565086716737923973120,6329993551182087077871740160000,43552355001059822999863541760000,291035839864576412693966598720000,
2268000228439305142046800151616000,15054743649222878865749902667250000,106422160731952815827300265229687500,723507661536999877609686003791001600,
5180841314667653678403627447180000000,35413180555550624728256176600328550000,276584253307062658718360629239034675200,
2044806498451955661182898522339795840000,15984648476490655551762818803674316800000,119207097827601216498393531090678664473600,
1036674751536226625891331901555260274932000,7767967974802231998731680280527133335879680,59859940698095803173345638271622421469600000,
463243765380984386693754172754202284518195200,3520153695325017750390444972601647320756400000,26924553727732181343981061043311577785948800000,
226359533555070276828985066102133901140820000000,1625363273552955311286049688310876003295407000000,12981197780434438509249413082340642691825400000000,
106342348483921251700771460069464467848613150000000,891677685835660967909099669671221691868774203392000,
8490593258695944830482613015926495887319444992000000,72048868306235870414361001985419523323132056772608000,
604876625306305463758631853482029052713623229562880000,5235660014332212079846308942462761127956096703037440000,
43457893784034374581807899319999375450824328479768576000,362888069836346076114461401934520007362470066573755752000,
3348346454567935900039402711692012966498349225331773440000,26401551303442330152645815681608726484736433710868463616000,
224255179109894586719367165463519485548656880243022431846400,1917905325992751291613920929538977802878971717971492644352000,
16454768681379514455672065904079728494181105766768127635200000,144661315041417698456118100325145554643800201105157513600000000,
1376242567875239336535077985767987649984605855706211736256000000,13113066715106912130303204023427654860447158744856469672925593600,
121116509957208270722552966870151542325857988770849835555225600000,1153115020813436329851764133504708869440063653277761419624841216000,
10622383556667010631074680150024493805368236556400528983358177280000,97212012945716879974623973334893577080881279951999201995390976000000,
961836105674529933127110136885177628435503859767835161600226230272000,8529359119791684911793051189830337190621571487220057478709698469888000,
77298031025746982669955290983446988928668869536016642064825737093120000,704075027190786372156224802059352211616140018855527145634848214876160000,
6496073399705336610728812461886496429452338685518066654114590041374720000,61105850461046018936012497939156189390815223954367538770745004243694976000,
565763252359217947976252927639984685899021991970674521094247412803994785008,5434819873738188364114622978012449368431533218068490636339957815938264934400,
52965521080352941494268841022401708228575598628364350309001257372578085000000,519789423921851243070282897803840771357447486826760236233713785482772480000000,
5422705606108343578599977668956503490933891714942526005960038698968715729305600,55146346778297795355567598885296507461527723051221049683527691060744932284170240, 556132774283440155479544435121355231732236424010959231971955664662747330641920000,5859333636113027877764702584289448709719981623494012061671485387884438460825600000,
57950792586943414473494019934466047186289979450577131957012930813489473126400000000,568742294288268469403855545257802536206299525166557359634038167789853396172800000000,
5590197292666837258558620529587460479473482449042301692857521676518619518353408000000,55595081721386351985194493607012900088479269181646423628997405593313118823555809280000,
554975262301964316016022873705361663925450774586813651104552626068095986431006195712000,5703407313412501264593171543241294279825842385411228120005742532549496562335709241280000,
57052593562119756074343220527307233399535922647398047715147972287779347973182467328000000,603210114482290829514094836344978258243425990465321190903241151564783282204277065332000000,
5894452660720018025739961205193422414632879022318835485611887859327183166263857650304000000,59986720128626828181358569008444574326547596958220056853986112055241687238910557913250000000,
619492467920462200202170713554851658562387483273781544290359217042277075160831629238281250000,6618900711570841745244266204533542564798433458172321742815577356826900080735898857572925440000,
72206783664550121375754437343233601610134627475067756826644274081995259950633194323600998400000,822419003539343049262221054803903240538882070976256216284944417360708642342899510804480000000000,
9008846542642293825209013395838838835069533099368885467859533472079192246258954747423022383104000,95610299441638646103304461982963718074915625376674348751627531942008775769721200588800000000000000,
1003109771804668155621482521962016272205110864112450999407721438231043467962208740719004641280000000,10891989144218074238864619564574518037990403389228111558536656361604261655607653042738078313562500000,
119063790270864380876842293940229264410269063506364430318013209265331161397555563340515319653376000000,1302374423064659751156256718543715892949357711619691668400155710762716321563463878654680110722000000000,
13694159160208438776802730849614300161979748484305724737288535218384667765061851597120790125941760000000,157341480890330533421986392752808660834292223356421576912133439212483893349099679854129786686629248000000,
1677818718472095531598516597616333522111506816963599409778203318964885347735109255648586850410516480000000,18374807119821886070221371605654266455605066909909854493486007408932365302988821125647851954929664000000000,
194334428582362988194998266766116037793392100563347187862210845904454265203254250141610320319498729553920000,2036737274962298301996891266280589462668162677404547010598022726546376153670397182508571635519520000000000000,
21905219605757240656036809606295366849861324974603892439915701951321181344641796365034941272177550336000000000,239990293985362953050096610088667152720434278577728231041163109604804014747524774958311144666382805216788480000,
2874569569397941515311864800887572527732524849012360215405794830184795483006056079795282447846279741440000000000,34663337154842791475172190351241337337707716791265947253861301716100655239713395850587316737241167666694062080000
];

WitnessPartitions3:=[{},{},{},{[4],[1,1,1,1]},{[2,1,1,1],[4,1]},{[2,2,1,1],[4,2]},{[4,1,1,1]},{[3,2,1,1,1],[5,2,1]},{[3,3,2,1],[4,3,2]},{[4,3,1,1,1],[5,2,2,1]},{[4,3,2,2],
[4,4,2,1]},{[6,3,2,1],[4,3,2,1,1,1]},{[6,4,2,1],[4,3,2,2,1,1]},{[5,3,3,2,1],[5,4,3,1,1]},{[5,3,3,2,1,1],[6,4,3,1,1]},{[6,3,3,2,1,1],[6,4,3,1,1,1]},
{[5,4,3,2,2,1],[6,5,3,2,1]},{[5,4,3,2,2,1,1],[7,5,3,2,1]},{[7,4,3,2,1,1,1]},{[7,5,4,2,1,1],[6,4,3,3,2,1,1]},{[7,5,4,2,2,1],[6,5,3,3,2,1,1]},{[7,5,3,2,2,1,1,1],
[8,5,3,2,2,1,1]},{[6,5,4,3,2,2,1],[7,6,4,3,2,1]},{[6,5,4,3,2,2,1,1],[8,6,4,3,2,1]},{[7,6,4,3,2,1,1,1],[8,5,4,3,2,2,1]},{[7,5,4,3,3,2,1,1],[8,6,5,3,2,1,1]},
{[8,6,5,3,2,2,1],[7,6,4,3,3,2,1,1]},{[7,6,5,4,3,2,1]},{[8,6,4,4,3,2,1,1],[8,6,5,4,2,2,1,1]},{[8,6,5,3,3,2,1,1,1],[9,6,5,3,3,2,1,1]},{[7,6,5,4,3,2,2,1,1],
[9,7,5,4,3,2,1]},{[9,6,5,4,3,2,2,1],[8,7,5,4,3,2,1,1,1]},{[10,7,5,4,3,2,1,1],[8,6,5,4,3,2,2,1,1,1]},{[9,6,5,4,3,3,2,1,1],[9,7,6,4,3,2,1,1,1]},
{[9,6,5,4,3,3,2,1,1,1],[10,7,6,4,3,2,1,1,1]},{[9,7,6,4,3,2,2,1,1,1],[10,7,5,4,3,3,2,1,1]},{[9,7,6,4,4,3,2,1,1],[9,7,6,5,3,3,2,1,1]},{[10,7,6,4,3,3,2,1,1,1]
},{[10,8,6,5,3,3,2,1,1],[9,7,6,4,4,3,2,2,1,1]},{[9,8,6,5,4,3,2,1,1,1],[10,7,6,5,4,3,2,2,1]},{[11,8,6,5,4,3,2,1,1],[9,7,6,5,4,3,2,2,1,1,1]},{[10,7,6,5,4,3,3,2,1,1],
[10,8,7,5,4,3,2,1,1,1]},{[10,7,6,5,4,3,3,2,1,1,1],[11,8,7,5,4,3,2,1,1,1]},{[11,8,6,5,4,3,3,2,1,1],[10,8,7,5,4,3,2,2,1,1,1]},{[11,8,7,5,4,3,3,2,1,1],
[10,8,7,5,4,3,3,2,1,1,1]},{[11,9,7,5,4,3,3,2,1,1],[10,8,7,5,4,3,3,2,2,1,1]},{[11,9,7,6,4,3,3,2,1,1],[10,8,7,5,4,4,3,2,2,1,1]},{[10,9,7,6,5,4,3,2,1,1],
[10,8,7,6,5,4,3,2,2,1]},{[10,9,7,6,5,4,3,2,1,1,1],[11,8,7,6,5,4,3,2,2,1]},{[12,9,7,6,5,4,3,2,1,1],[10,8,7,6,5,4,3,2,2,1,1,1]},{[11,9,7,6,5,4,3,2,1,1,1,1],
[12,8,7,6,5,4,3,2,2,1,1]},{[11,8,7,6,5,4,3,3,2,1,1,1],[12,9,8,6,5,4,3,2,1,1,1]},{[11,9,8,6,5,4,3,2,2,1,1,1],[12,9,7,6,5,4,3,3,2,1,1]},{[11,9,8,6,5,4,3,3,2,1,1,1],
[12,9,8,6,5,4,3,3,2,1,1]},{[12,10,8,6,5,4,3,3,2,1,1],[11,9,8,6,5,4,3,3,2,2,1,1]},{[12,10,8,6,5,4,3,2,2,2,1,1],[12,10,7,6,5,4,3,3,2,2,1,1]},{[12,10,8,7,5,4,3,3,2,1,1,1],
[12,9,8,6,5,4,4,3,2,2,1,1]},{[12,9,8,6,5,4,4,3,2,2,1,1,1],[13,10,8,7,5,4,3,3,2,1,1,1]},{[12,9,8,7,6,5,4,3,2,1,1,1]},{[11,9,8,7,6,5,4,3,2,2,1,1,1],[13,10,8,7,6,5,4,3,2,1,1]},
{[13,9,8,7,6,5,4,3,2,2,1,1],[12,10,8,7,6,5,4,3,2,1,1,1,1]},{[13,10,8,7,6,5,4,3,2,1,1,1,1],[13,10,9,7,6,5,4,3,2,1,1,1],[13,9,8,7,6,5,4,3,2,2,1,1,1],
[12,9,8,7,6,5,4,3,3,2,1,1,1]},{[13,10,8,7,6,5,4,3,3,2,1,1],[12,10,9,7,6,5,4,3,2,2,1,1,1]},{[13,10,8,7,6,5,4,3,2,2,2,1,1],[13,11,8,7,6,5,4,3,2,2,1,1,1]},
{[12,10,9,7,6,5,4,3,3,2,2,1,1],[13,11,9,7,6,5,4,3,3,2,1,1]},{[13,11,9,7,6,5,4,3,2,2,2,1,1],[13,11,8,7,6,5,4,3,3,2,2,1,1]},{[13,11,9,8,6,5,4,3,3,2,1,1,1],
[13,10,9,7,6,5,4,4,3,2,2,1,1]},{[13,10,9,7,6,5,4,4,3,2,2,1,1,1],[14,11,9,8,6,5,4,3,3,2,1,1,1]},{[13,11,9,8,6,5,4,3,3,2,2,1,1,1],[14,11,9,7,6,5,4,4,3,2,2,1,1]},
{[14,11,9,8,7,5,4,3,3,2,2,1,1],[13,11,9,7,6,5,5,4,3,2,2,1,1,1]},{[13,11,9,8,6,5,5,4,3,2,2,1,1,1],[14,11,9,8,7,5,4,4,3,2,2,1,1]},{[14,11,9,8,7,5,4,4,3,2,2,1,1,1],
[14,11,9,8,6,5,5,4,3,2,2,1,1,1]},{[14,10,9,8,7,6,5,4,3,2,2,1,1,1],[14,11,9,8,7,6,5,4,3,2,1,1,1,1]},{[14,11,9,8,7,6,5,4,3,3,2,1,1],[13,11,10,8,7,6,5,4,3,2,2,1,1,1]},
{[14,11,9,8,7,6,5,4,3,2,2,2,1,1],[14,12,9,8,7,6,5,4,3,2,2,1,1,1]},{[13,11,9,8,7,6,5,4,3,3,2,2,1,1,1],[15,12,10,8,7,6,5,4,3,2,2,1,1]},{[14,12,10,8,7,6,5,4,3,2,2,2,1,1],
[14,12,9,8,7,6,5,4,3,3,2,2,1,1]},{[15,12,10,8,7,6,5,4,3,2,2,2,1,1],[14,12,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[14,11,10,8,7,6,5,4,4,3,2,2,1,1,1],[15,12,10,9,7,6,5,4,3,3,2,1,1,1]},
{[14,12,10,9,7,6,5,4,3,3,2,2,1,1,1],[15,12,10,8,7,6,5,4,4,3,2,2,1,1]},{[15,13,10,8,7,6,5,4,3,3,2,2,1,1,1],[15,12,10,8,7,6,5,4,3,3,2,2,2,1,1]},
{[15,12,10,9,8,6,5,4,3,3,2,2,1,1,1],[15,12,10,8,7,6,5,5,4,3,2,2,1,1,1]},{[15,12,10,9,7,6,5,4,4,3,2,2,2,1,1],[15,13,10,9,7,6,5,4,4,3,2,2,1,1,1]},
{[16,13,11,9,7,6,5,4,3,3,2,2,1,1,1],[15,12,10,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[15,12,10,9,7,6,5,5,4,3,3,2,2,1,1],[15,13,11,9,8,6,5,4,4,3,2,2,1,1,1]},
{[15,12,10,9,8,7,6,5,4,3,3,2,1,1],[14,12,11,9,8,7,6,5,4,3,2,2,1,1,1]},{[15,13,10,9,8,7,6,5,4,3,2,2,1,1,1],[15,12,10,9,8,7,6,5,4,3,2,2,2,1,1]},
{[14,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[16,13,11,9,8,7,6,5,4,3,2,2,1,1]},{[15,13,11,9,8,7,6,5,4,3,2,2,2,1,1],[15,13,10,9,8,7,6,5,4,3,3,2,2,1,1]},
{[16,13,11,9,8,7,6,5,4,3,2,2,2,1,1],[15,13,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[16,13,11,9,8,7,6,5,4,3,2,2,2,1,1,1],[16,13,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[16,13,11,9,8,7,6,5,4,4,3,2,2,1,1],[15,13,11,10,8,7,6,5,4,3,3,2,2,1,1,1]},{[15,13,11,10,8,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,4,4,3,2,2,1,1]},
{[16,13,11,9,8,7,6,5,4,4,3,2,2,1,1,1,1],[17,13,11,10,8,7,6,5,4,3,3,2,2,1,1,1]},{[16,13,12,10,8,7,6,5,4,4,3,2,2,1,1,1],[16,13,11,10,8,7,6,5,4,4,3,3,2,1,1,1]},
{[16,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1],[16,14,12,10,9,7,6,5,4,3,3,2,2,1,1,1]},{[16,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[17,14,12,10,9,7,6,5,4,3,3,2,2,1,1,1]},
{[16,14,11,10,8,7,6,5,4,4,3,3,2,2,1,1,1],[17,14,12,10,8,7,6,5,4,4,3,2,2,2,1,1]},{[16,14,12,10,9,7,6,5,4,4,3,3,2,2,1,1],[16,14,12,10,8,7,6,5,5,4,3,3,2,2,1,1]},
{[17,14,12,10,9,7,6,5,4,4,3,3,2,2,1,1],[16,14,12,10,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[17,14,12,10,9,8,7,6,5,4,3,2,2,1,1],[15,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[16,14,12,10,9,8,7,6,5,4,3,2,2,2,1,1],[16,14,11,10,9,8,7,6,5,4,3,3,2,2,1,1]},{[17,14,12,10,9,8,7,6,5,4,3,2,2,2,1,1],[16,14,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[17,14,12,10,9,8,7,6,5,4,3,2,2,2,1,1,1],[17,14,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[17,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1],[16,14,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[17,15,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[17,14,12,10,9,8,7,6,5,4,3,3,2,2,2,1,1]},{[18,14,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1],[17,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1,1]},
{[17,14,12,11,9,8,7,6,5,4,4,3,2,2,2,1,1],[17,15,12,11,9,8,7,6,5,4,4,3,2,2,1,1,1]},{[18,15,12,11,9,8,7,6,5,4,4,3,2,2,1,1,1],[17,14,12,11,9,8,7,6,5,4,4,3,2,2,2,1,1,1]},
{[18,15,13,11,9,8,7,6,5,4,3,3,2,2,1,1,1,1],[18,14,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},{[18,15,13,11,9,8,7,6,5,4,4,3,2,2,2,1,1],[17,15,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1]},
{[17,15,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1],[17,15,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1]},{[18,15,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1],[17,15,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1,1]},
{[19,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1],[18,15,13,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1,1]},{[19,15,13,11,10,8,7,6,5,4,4,3,3,2,2,1,1,1],[18,15,13,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1,1]},
{[18,15,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1,1],[19,15,13,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[18,15,13,11,10,9,8,7,6,5,4,3,2,2,2,1,1],[17,15,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[18,15,13,11,10,9,8,7,6,5,4,3,3,2,1,1,1,1],[18,14,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[17,15,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,9,8,7,6,5,4,4,3,2,2,1,1]},
{[18,15,13,11,10,9,8,7,6,5,4,3,3,2,2,2,1,1],[18,16,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[19,15,13,12,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[18,15,13,11,10,9,8,7,6,5,4,4,3,2,2,1,1,1,1]},
{[18,16,13,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1],[18,15,13,12,10,9,8,7,6,5,4,4,3,2,2,2,1,1]},{[18,15,13,12,10,9,8,7,6,5,4,4,3,2,2,2,1,1,1],[19,16,13,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1]},
{[18,15,13,11,10,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[19,15,13,12,10,9,8,7,6,5,4,4,3,3,2,2,1,1,1],[19,16,14,12,10,9,8,7,6,5,4,4,3,2,2,1,1,1,1]},
{[18,16,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1],[18,16,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1]},{[18,16,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1],[19,16,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1]},
{[18,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1]},{[19,16,14,12,11,9,8,7,6,5,4,4,3,3,2,2,1,1,1,1],[20,16,14,12,10,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},
{[19,16,14,12,11,9,8,7,6,5,5,4,3,3,2,2,2,1,1],[19,17,14,12,11,9,8,7,6,5,5,4,3,3,2,2,1,1,1]},{[19,16,14,12,11,9,8,7,6,6,5,4,3,3,2,2,1,1,1,1],[20,16,14,12,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1]},
{[20,17,14,12,11,10,8,7,6,5,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,9,8,7,6,6,5,4,3,3,2,2,2,1,1,1]},{[19,16,14,12,11,10,9,8,7,6,5,4,3,2,2,2,1,1,1],[19,16,13,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},
{[19,16,14,12,11,10,9,8,7,6,5,4,4,3,2,2,1,1],[18,16,14,13,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1]},{[19,17,14,12,11,10,9,8,7,6,5,4,3,3,2,2,1,1,1],[19,16,14,12,11,10,9,8,7,6,5,4,3,3,2,2,2,1,1]}
];

if(n le #MaximalDegrees3) then
  return MaximalDegrees3[n],WitnessPartitions3[n];
end if;

num:=NumberOfPartitions(n);
P:=[n];
MaxDeg:=0;
TheChars:={};
MaxDeg2:=0;
TheChars2:={};
MaxDeg3:=0;
TheChars3:={};

g:=Sym(n)!1;
for i in [1..num] do
  nn:=SymmetricCharacterValue(P,g);
  if(nn gt MaxDeg) then
    MaxDeg3:=MaxDeg2;
    MaxDeg2:=MaxDeg;
    MaxDeg:=nn;
    TheChars3:=TheChars2;
    TheChars2:=TheChars;
    TheChars:={P};
  elif(nn eq MaxDeg) then
    Include(~TheChars,P);
  elif(nn gt MaxDeg2) then
    MaxDeg3:=MaxDeg2;
    MaxDeg2:=nn;
    TheChars3:=TheChars2;
    TheChars2:={P};
  elif(nn eq MaxDeg2) then
    Include(~TheChars2,P);
  elif(nn gt MaxDeg3) then
    MaxDeg3:=nn;
    TheChars3:={P};
  elif(nn eq MaxDeg3) then
    Include(~TheChars3,P);
  end if;
  P:=NextPartition(P,n);
end for;

return MaxDeg3,TheChars3;

end intrinsic;

 












